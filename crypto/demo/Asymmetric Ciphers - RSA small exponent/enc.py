from Crypto.Util.number import getPrime
from Crypto.Util.number import getPrime

def genkey():
    e = 3 
    p = q = 1
    while p%e==1 or q%e==1:
        p = getPrime(512)
        q = getPrime(512)
    return (p,q,e)

def enc(m,n,e):
    m = int.from_bytes(m, 'big')
    n = p*q
    c = pow(m,e,n)
    return c

p,q,e = genkey()
n = p*q
m = open("flag","rb").read()
print(f"{n = }")
print(f"{e = }")

c = enc(m,n,e)
print(f"{c = }")

'''
n = 59758126497721946566892324688467834114393584607415121566562237064689786802265353878279025995373636544213155791122591261989487693557391029317766869867356959703730647483903383030904078669877428674284642614683059270350526553243056682048151245490254283712877973928246383588362760638972689442451343077003402257839
e = 3
c = 1765606141459880523742652887097405486809893265842266652835612373703511939899902632464451032595573585552759553805446688364708997016499966219360485459737635726557357318973438560812628092298185192666729435477927438968899252959598993651489125
'''
