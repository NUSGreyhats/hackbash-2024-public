from Crypto.Util.number import isPrime 
from random import randint

def genkey():
    e = 65537
    p = randint(1,1<<512)
    while p%e==1 or not isPrime(p):
        p += 1
    q = p+1
    while q%e==1 or not isPrime(q):
        q += 1
    return (p,q,e)

def enc(m,n,e):
    m = int.from_bytes(m, 'big')
    n = p*q
    c = pow(m,e,n)
    return c

p,q,e = genkey()
n = p*q
m = open("flag","rb").read()
print(f"{n = }")
print(f"{e = }")

c = enc(m,n,e)
print(f"{c = }")

'''
n = 254571571237335262221648156847964616045947107745992838805199027563982053933395990563948897926728721298016679673357286034219552860974773767099225433525763540396688442644330296286828929889051603995707629962097691318241898300118043619494888073399870699393931850871615037126384007825167100023884874065637848941
e = 65537
c = 232986787583495161055029820557605465283806589353046217200843816237569257949711539496328961420264869786167600554299054302813522154466172079154162909819396034925085092410876087536655598886713758551921580970515822887324610581053234750188604089549139077644884713720515833092408927570673295471536619678586167356
'''
