from Crypto.Util.number import getPrime
from Crypto.Util.number import getPrime

def genkey():
    e = 65537
    p = q = 1
    while p%e==1 or q%e==1:
        p = getPrime(512)
        q = getPrime(512)
    return (p,q,e)

def enc(m,p,q,e):
    m = int.from_bytes(m, 'big')
    n = p*q
    c = pow(m,e,n)
    return c

p,q,e = genkey()
m = open("flag","rb").read()
print(f"{p = }")
print(f"{q = }")
print(f"{e = }")

c = enc(m,p,q,e)
print(f"{c = }")

'''
p = 8600093133857912938951388847247943324093478478210116579971979117230297894386242857670150514280313000040862808116201494003050984693981693419864535801685237
q = 11656820996162367775002476163859181609725813868544312451534500092560856496091457270170163239090263183863970768078952655637835377873087771973658158812072181
e = 65537
c = 26876975342968084790141582411627530080014168567032526910385099205649305207680418526944965396639442739780894290794633000449789516463876341000020209715189355852666183939407891220331220423682242561396137039859303352284732354016246280016833046310798495094218930424047420121599840545969697589814188340263845373686
'''
